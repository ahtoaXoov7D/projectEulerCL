# Benchmark

## Ntt benchmark

### Test Environment:

* OS:  Win10 Pro 1803
* CPU: i7-4790K (MMX, SSE, SSE2, SSE3, SSE4.1, SSE4.2, EM64T, VT-x, AES, AVX, AVX2, FMA3)
* Compiler: MinGW-x86_64-8.1.0-win32-seh-rt_v6-rev0
* Msys2: msys2-x86_64-20190524
* Test code: [Ntt test](https://github.com/baihacker/pe/blob/master/test/ntt_test.c)
* Build libbf:
  > gcc -Wall -O3 -mavx -mavx2 -mfma -mbmi2 -c -o libbf.avx2.o libbf.c
 
  > gcc -Wall -O3 -mavx -mavx2 -mfma -mbmi2 -c -o cutils.avx2.o cutils.c
 
  > gcc-ar crv libbf.avx2.a cutils.avx2.o libbf.avx2.o
* Build test target:
  > -o a.exe --std=c++11 -O3 -march=native -mtune=native -fopenmp -Wl,--stack,268435456 -lbf -lgmpxx -lflint -lgmp -lmpfr -lmpir

### Test result

#### Openmp enabled
```cpp
ntt test : data = random, size = 0, n = 1000000, mod = 100019
flint n  : 0.407
flint p  : 1.156
ntt32 s  : 1.031
ntt32 l  : 1.156
ntt64 s  : 1.578
ntt64 l  : 1.656
Min_25 s : 0.156
Min_25 l : 0.203
libbf    : 0.828
ntt test : data = random, size = 1, n = 1479725, mod = 100000000003
flint n  : 1.234
flint p  : 2.890
ntt32 l  : 2.375
ntt64 l  : 3.391
Min_25 l : 0.343
libbf    : 1.359
ntt test : data = random, size = 2, n = 1000000, mod = 316227766016779
flint n  : 0.843
flint p  : 2.063
ntt64 l  : 1.671
Min_25 l : 0.203
libbf    : 0.859
ntt test : data = max mod, size = 0, n = 999996, mod = 1000003
flint n  : 0.422
flint p  : 1.234
ntt32 s  : 0.984
ntt32 l  : 1.156
ntt64 s  : 1.515
ntt64 l  : 1.651
Min_25 s : 0.141
Min_25 l : 0.172
libbf    : 0.813
ntt test : data = max mod, size = 1, n = 1479725, mod = 100000000003
flint n  : 1.234
flint p  : 2.750
ntt32 l  : 2.359
ntt64 l  : 3.422
Min_25 l : 0.359
libbf    : 1.375
ntt test : data = max mod, size = 2, n = 1000000, mod = 316227766016779
flint n  : 0.829
flint p  : 2.077
ntt64 l  : 1.703
Min_25 l : 0.172
libbf    : 0.859

mod = 100019
log2(n)  10     11     12     13     14     15     16     17     18     19     20
flint n  0.016  0.000  0.000  0.000  0.000  0.000  0.016  0.032  0.079  0.219  0.422
flint p  0.000  0.000  0.000  0.000  0.016  0.031  0.063  0.140  0.282  0.594  1.219
ntt32 s  0.000  0.000  0.016  0.000  0.016  0.047  0.062  0.109  0.235  0.484  1.000
ntt32 l  0.000  0.000  0.000  0.015  0.016  0.047  0.062  0.125  0.281  0.578  1.187
ntt64 s  0.000  0.000  0.016  0.016  0.031  0.062  0.094  0.172  0.375  0.734  1.531
ntt64 l  0.000  0.000  0.016  0.015  0.032  0.062  0.094  0.188  0.406  0.813  1.687
Min_25 s 0.000  0.015  0.000  0.000  0.000  0.016  0.016  0.016  0.032  0.062  0.141
Min_25 l 0.000  0.000  0.000  0.000  0.000  0.015  0.016  0.032  0.031  0.078  0.172
libbf    0.000  0.000  0.000  0.000  0.000  0.015  0.047  0.093  0.188  0.406  0.843
mod = 100000000003
log2(n)  10     11     12     13     14     15     16     17     18     19     20
flint n  0.016  0.000  0.000  0.000  0.000  0.016  0.031  0.062  0.140  0.390  0.859
flint p  0.000  0.000  0.000  0.000  0.016  0.047  0.094  0.203  0.422  0.906  1.907
ntt32 l  0.000  0.000  0.000  0.015  0.031  0.047  0.078  0.141  0.297  0.594  1.187
ntt64 l  0.016  0.000  0.000  0.015  0.031  0.063  0.093  0.203  0.391  0.828  1.672
Min_25 l 0.000  0.000  0.000  0.000  0.016  0.015  0.016  0.031  0.047  0.094  0.265
libbf    0.000  0.000  0.000  0.000  0.016  0.031  0.047  0.094  0.203  0.421  0.875
mod = 316227766016779
log2(n)  10     11     12     13     14     15     16     17     18     19     20
flint n  0.000  0.000  0.000  0.000  0.000  0.016  0.047  0.110  0.203  0.391  0.828
flint p  0.000  0.016  0.000  0.016  0.031  0.047  0.125  0.234  0.468  1.016  2.124
ntt64 l  0.000  0.000  0.016  0.016  0.031  0.062  0.094  0.204  0.406  0.813  1.672
Min_25 l 0.000  0.000  0.016  0.000  0.000  0.000  0.015  0.016  0.046  0.078  0.172
libbf    0.000  0.000  0.015  0.000  0.016  0.016  0.047  0.093  0.203  0.437  0.875
```

#### Openmp disabled (option "-fopenmp" removed)
```cpp
ntt test : data = random, size = 0, n = 1000000, mod = 100019
flint n  : 0.406
flint p  : 1.172
ntt32 s  : 2.968
ntt32 l  : 4.531
ntt64 s  : 2.500
ntt64 l  : 5.015
Min_25 s : 0.172
Min_25 l : 0.344
libbf    : 0.812
ntt test : data = random, size = 1, n = 1479725, mod = 100000000003
flint n  : 1.234
flint p  : 2.906
ntt32 l  : 9.470
ntt64 l  : 10.530
Min_25 l : 0.719
libbf    : 1.359
ntt test : data = random, size = 2, n = 1000000, mod = 316227766016779
flint n  : 0.828
flint p  : 2.078
ntt64 l  : 5.077
Min_25 l : 0.391
libbf    : 0.844
ntt test : data = max mod, size = 0, n = 999996, mod = 1000003
flint n  : 0.406
flint p  : 1.250
ntt32 s  : 2.970
ntt32 l  : 4.531
ntt64 s  : 2.469
ntt64 l  : 4.952
Min_25 s : 0.156
Min_25 l : 0.328
libbf    : 0.813
ntt test : data = max mod, size = 1, n = 1479725, mod = 100000000003
flint n  : 1.218
flint p  : 2.766
ntt32 l  : 9.483
ntt64 l  : 10.517
Min_25 l : 0.734
libbf    : 1.359
ntt test : data = max mod, size = 2, n = 1000000, mod = 316227766016779
flint n  : 0.828
flint p  : 2.078
ntt64 l  : 5.000
Min_25 l : 0.422
libbf    : 0.844

mod = 100019
log2(n)  10     11     12     13     14     15     16     17     18     19     20
flint n  0.000  0.000  0.000  0.016  0.000  0.016  0.015  0.032  0.078  0.219  0.421
flint p  0.000  0.000  0.000  0.016  0.016  0.031  0.062  0.140  0.281  0.578  1.234
ntt32 s  0.000  0.000  0.015  0.016  0.031  0.078  0.141  0.297  0.641  1.390  3.000
ntt32 l  0.000  0.000  0.016  0.031  0.047  0.109  0.219  0.469  0.985  2.093  4.546
ntt64 s  0.000  0.000  0.016  0.000  0.015  0.047  0.125  0.266  0.562  1.188  2.500
ntt64 l  0.000  0.000  0.016  0.031  0.047  0.110  0.250  0.531  1.110  2.343  4.999
Min_25 s 0.000  0.000  0.000  0.000  0.016  0.000  0.000  0.031  0.032  0.062  0.171
Min_25 l 0.000  0.000  0.000  0.000  0.000  0.000  0.015  0.047  0.078  0.172  0.360
libbf    0.000  0.000  0.000  0.015  0.000  0.015  0.047  0.094  0.203  0.406  0.812
mod = 100000000003
log2(n)  10     11     12     13     14     15     16     17     18     19     20
flint n  0.000  0.000  0.000  0.000  0.015  0.016  0.031  0.046  0.125  0.391  0.875
flint p  0.000  0.000  0.015  0.016  0.015  0.047  0.094  0.203  0.422  0.907  1.891
ntt32 l  0.000  0.015  0.016  0.016  0.062  0.109  0.219  0.469  1.000  2.140  4.562
ntt64 l  0.000  0.000  0.000  0.032  0.062  0.125  0.250  0.531  1.125  2.375  5.077
Min_25 l 0.000  0.000  0.000  0.000  0.016  0.016  0.031  0.046  0.093  0.187  0.406
libbf    0.000  0.000  0.000  0.000  0.015  0.031  0.078  0.093  0.203  0.422  0.859
mod = 316227766016779
log2(n)  10     11     12     13     14     15     16     17     18     19     20
flint n  0.000  0.000  0.016  0.000  0.016  0.015  0.047  0.093  0.203  0.391  0.828
flint p  0.000  0.000  0.015  0.000  0.016  0.047  0.109  0.234  0.469  1.015  2.140
ntt64 l  0.000  0.000  0.016  0.031  0.063  0.125  0.265  0.531  1.125  2.406  5.109
Min_25 l 0.000  0.000  0.000  0.000  0.015  0.016  0.031  0.047  0.078  0.188  0.422
libbf    0.000  0.000  0.000  0.016  0.000  0.015  0.047  0.094  0.219  0.437  0.859
```
