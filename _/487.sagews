︠95d739a4-f7fc-4d14-94bb-5d87c3224ed1s︠

%cython
#clang g++

import sage.all as _
ctypedef long long int64

cdef int64 nn = 10**12
cdef int K = 10**4, N = K + 10
cdef int S[10010][10010]
cdef int MOD = 2 * 10**9
cdef int i, j
cdef int inv[10010]

cdef int PS(int64 n, int k) :
    cdef int64 ret = 0, i, fac = 1
    n = n + 1
    for i from 0 <= i <= k :
        fac = fac * (n % MOD) % MOD
        n = n - 1
        ret += S[k][i] * fac % MOD * inv[i + 1] % MOD
    return ret % MOD

cdef int64 ans = 0

while True :
    MOD = _.next_prime(MOD)
    if MOD > 2 * 10**9 + 2000 :
        break
    S[0][0] = 1

    for i in range(1, N) :
        for j in range(1, N) :
            S[i][j] = (S[i - 1][j] * <int64>j + S[i - 1][j - 1]) % MOD
    for i in range(1, N) :
        inv[i] = pow(i, MOD - 2, MOD)
    
    ans += ((nn + 1) % MOD * PS(nn, K) % MOD + MOD - PS(nn, K + 1)) % MOD
    print ans, MOD
print ans

︡a31b29d7-6d07-4b3e-8bc6-a37a5766cd0d︡{"stdout":"1964058632"}︡{"stdout":" 2000000011\n3136377714"}︡{"stdout":" 2000000033\n4293399232"}︡{"stdout":" 2000000063\n5972942829"}︡{"stdout":" 2000000087\n6414831209"}︡{"stdout":" 2000000089\n6512218469"}︡{"stdout":" 2000000099\n8087158904"}︡{"stdout":" 2000000137\n9681880551"}︡{"stdout":" 2000000141\n11528106812"}︡{"stdout":" 2000000143\n11726439970"}︡{"stdout":" 2000000153\n12358030058"}︡{"stdout":" 2000000203\n12518014467"}︡{"stdout":" 2000000227\n12730313488"}︡{"stdout":" 2000000239\n13899014581"}︡{"stdout":" 2000000243\n13986688217"}︡{"stdout":" 2000000269\n15575163790"}︡{"stdout":" 2000000273\n16278539921"}︡{"stdout":" 2000000279\n17053439770"}︡{"stdout":" 2000000293\n18949188475"}︡{"stdout":" 2000000323\n20130095552"}︡{"stdout":" 2000000333\n20371196759"}︡{"stdout":" 2000000357\n22170071278"}︡{"stdout":" 2000000381\n23604428788"}︡{"stdout":" 2000000393\n25189299974"}︡{"stdout":" 2000000407\n26139891345"}︡{"stdout":" 2000000413\n26507780039"}︡{"stdout":" 2000000441\n26705523417"}︡{"stdout":" 2000000503\n28157209657"}︡{"stdout":" 2000000507\n29361256492"}︡{"stdout":" 2000000531\n31109515550"}︡{"stdout":" 2000000533\n31708680155"}︡{"stdout":" 2000000579\n32634335351"}︡{"stdout":" 2000000603\n33717534612"}︡{"stdout":" 2000000609\n35102176901"}︡{"stdout":" 2000000621\n36843088083"}︡{"stdout":" 2000000641\n37120250142"}︡{"stdout":" 2000000659\n38251248822"}︡{"stdout":" 2000000671\n38476921729"}︡{"stdout":" 2000000693\n40475495776"}︡{"stdout":" 2000000707\n42455875958"}︡{"stdout":" 2000000731\n42482886807"}︡{"stdout":" 2000000741\n43105440401"}︡{"stdout":" 2000000767\n43845714558"}︡{"stdout":" 2000000771\n45222670493"}︡{"stdout":" 2000000773\n46252488909"}︡{"stdout":" 2000000789\n47948109719"}︡{"stdout":" 2000000797\n49744057203"}︡{"stdout":" 2000000809\n51480701654"}︡{"stdout":" 2000000833\n51989693756"}︡{"stdout":" 2000000837\n53819834559"}︡{"stdout":" 2000000843\n54290813235"}︡{"stdout":" 2000000957\n55808445047"}︡{"stdout":" 2000000983\n57576412674"}︡{"stdout":" 2000001001\n58760104529"}︡{"stdout":" 2000001013\n59925645013"}︡{"stdout":" 2000001043\n61880639374"}︡{"stdout":" 2000001049\n62694037005"}︡{"stdout":" 2000001089\n62906516156"}︡{"stdout":" 2000001097\n63013875595"}︡{"stdout":" 2000001103\n64759115315"}︡{"stdout":" 2000001109\n65678468605"}︡{"stdout":" 2000001119\n66720225361"}︡{"stdout":" 2000001127\n67125702229"}︡{"stdout":" 2000001137\n67923638682"}︡{"stdout":" 2000001149\n68675713891"}︡{"stdout":" 2000001151\n70191749172"}︡{"stdout":" 2000001167\n71348148706"}︡{"stdout":" 2000001173\n73119027067"}︡{"stdout":" 2000001187\n74662674339"}︡{"stdout":" 2000001229\n75301334824"}︡{"stdout":" 2000001233\n77050062038"}︡{"stdout":" 2000001247\n77868969714"}︡{"stdout":" 2000001257\n79691669627"}︡{"stdout":" 2000001277\n81605520053"}︡{"stdout":" 2000001287\n81985336691"}︡{"stdout":" 2000001349\n83525285215"}︡{"stdout":" 2000001359\n84482532225"}︡{"stdout":" 2000001379\n86463873575"}︡{"stdout":" 2000001413\n87219910188"}︡{"stdout":" 2000001457\n88404271259"}︡{"stdout":" 2000001511\n88959535960"}︡{"stdout":" 2000001517\n89405973898"}︡{"stdout":" 2000001527\n91151653083"}︡{"stdout":" 2000001539\n91168778898"}︡{"stdout":" 2000001551\n92084381310"}︡{"stdout":" 2000001557\n93285653288"}︡{"stdout":" 2000001583\n95150844578"}︡{"stdout":" 2000001599\n96404418551"}︡{"stdout":" 2000001623\n97802860862"}︡{"stdout":" 2000001629\n98633316090"}︡{"stdout":" 2000001649\n100205707153"}︡{"stdout":" 2000001677\n100995378863"}︡{"stdout":" 2000001727\n101908783019"}︡{"stdout":" 2000001743\n102510519694"}︡{"stdout":" 2000001821\n104051238127"}︡{"stdout":" 2000001833\n104199354171"}︡{"stdout":" 2000001851\n104652876068"}︡{"stdout":" 2000001881\n105926992074"}︡{"stdout":" 2000001929\n106074206905"}︡{"stdout":" 2000001953\n106650212746"}︡{"stdout":" 2000001973\n106650212746\n"}︡{"html":"<a href='/0eaa1bc6-6816-4676-9623-9307e7983202/raw/.sage/temp/compute3dc1/12901/spyx/_projects_0eaa1bc6_6816_4676_9623_9307e7983202__sage_temp_compute3dc1_12901_dir_Vj36kz_a_pyx/_projects_0eaa1bc6_6816_4676_9623_9307e7983202__sage_temp_compute3dc1_12901_dir_Vj36kz_a_pyx_0.html' target='_new' class='btn btn-small' style='margin-top: 1ex'>Auto-generated code... &nbsp;<i class='fa fa-external-link'></i></a>"}︡
︠580fb0d8-4812-400d-98bf-23e27d532910︠
print 35375333830 %  2000000011
︡9f883bb6-3fd9-4fea-8a1a-0c2adb50ebd1︡{"stdout":"1375333643\n"}︡
︠c9df8381-408a-413e-bcd1-28b7d83629e0︠









